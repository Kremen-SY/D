#  Анализ и описание архитектурных опций, и обоснование выбора.

1. Для виртуализации выбирается Docker, для оркестрации ‑ Kubernetes. Альтернатив по большому счету нет, важным критерием является растространнеость ПО – возможность его поддержки облачным провайдером, наличие большого комьюнити и большого количества документации и большого выбора совместимого ПО. При размещении в облаке k8s следует разместить на виртуальной машине BareMetalHypervisor (VMWareESXi или аналоги)
2. Легкая интеграция с другими приложениями компании подразумевает использование единого аккаунта с бесшовным переходом между приложениями (использование SSO – это так же решит проблемы с безопасностью, будут использоваться JWTToken, протоколы OAuth 2.0, TLS, двухфакторная аутентификация) и открытие ссылок в приложении (DeepLink)
3. Требуется подключение специальных приборов/датчиков, а значит не получится использовать технологию PWA-сайт, выглядящий как мобильное приложение и придется поддерживать нативные приложения (Java на Android и Swift на IOS) в. т.ч. на устаревших ОС. Впрочем, можно сделать гибридное приложение – часть данных обрабатывать на сервере.
4. Нестабильное соединение с сетью требует обработки данных на устройстве пользователя, т.е. пользователь должен иметь возможность проводить тренировку с использованием сторонних приборов/датчиков и/или фитнес-функций смартфона без подключения к интернету, а также запоминать геолокацию и корректировать ее без подключения к интернету.
5. Можно использовать гарантированную доставку сообщений при взаимодействии с сервером или просто использовать Retry несколько раз в случае ошибок сети, никаких критичных данных в приложении нет, если какие-то запросы потеряются это никак не отразится на рaботе приложения. В общем очевидных преимуществ использования корпоративной сервисной шины нет, скорее всего достаточно будет Serviсemesh.
6. Мониторинг можно осуществлять, не затрагивая код приложения (например, Zabbix) или затрагивая (использование библиотек OpenTelemetry). Поскольку приложение создается с нуля и не содержит legacy второй способ предпочтительнее.
7. При наличии сложной бизнес-логики возможно применение BPM в качестве middle-layer (Camunda), но предварительно приложение не выглядит сложным.
8. По предварительной оценке, EventSourcing не нужен – больших нагрузок на один сервер не подразумевается, (а с датчиками он и так используется). Все кроме датчиков может общаться через синхронный API.
9. Для внешних приложений (мобильные приложениями на стороне пользователя) требуется использовать APIGateway (например, WSO2)
## Потребуются следующие БД и хранилища данных:
  1. Для хранения персональных данных пользователя (предлагается хранить данные пользователя в SSO, подойдет любая SQL БД, например, PostgreSQL)
  2. Для хранения результатов от датчиков TimeSeriesDB.
  3. Большинство средств мониторинга (такие как Loki, Prometheus, Jaeger поставляются со своими БД, если они не устраивают, можно использовать Elastic)
  4. Для хранения прочей информации из аккаунта пользователя: спортивный инвентарь, список групп и друзей, список тренировок, расписание тренировок. Из всего этого только спортивный инвентарь имеет динамическую модель данных и для него предпочтительнее будет NoSQL BD (Хотя тот же PostgreSQL позволяет использовать динамическую модель). Так что здесь преимущества не очевидны, но предварительно выберем NoSQL БД (например, MongoDB)
  5. При необходимости внутреннего кеширования можно использовать Redis
  6. NetworkFileSystem (NFS) для хранения картинок
